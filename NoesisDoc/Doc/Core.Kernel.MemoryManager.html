<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.13.1: http://docutils.sourceforge.net/" />
<title>noesisGUI Documentation: Memory Management</title>


    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta name="description" content="NoesisGUI Documentation"/>
    
    <meta name="viewport" content="width=device-width,initial-scale=1">
    
    <link rel="shortcut icon" href="/favicon.ico">

    <!--script src="https://use.typekit.net/taq4txx.js"></script-->
    <!--script>try{Typekit.load({ async: true });}catch(e){}</script-->

    <link rel="stylesheet" href="style/noesis.css" type="text/css" media="all"/>

    <script type="text/javascript" src="/js/googleAnalytics.js?version=1.0"></script>
    <!--[if lt IE 7]><script src="http://ie7-js.googlecode.com/svn/version/2.0(beta3)/IE7.js" type="text/javascript"></script><![endif]-->

    <script src="/js/vendor/modernizr.js"></script>


</head>
<body>
<div class="document" id="memory-management">


    <!-- NOESIS WEB ------- BEGIN ------- -->

    <div class="developers documentation">

        <!--[if lt IE 9]>
        <script type="text/javascript" src="/js/vendor/selectivizr.js"></script>
        <script type="text/javascript" src="/js/vendor/respond.js"></script>
        <div class="old-browser-warning">
            You are using a very old browser.<br>
            To get the best possible experience using our website we recommend that you upgrade to a newer version or other web browser. <br>
            A list of the most popular web browsers <a href="http://browsehappy.com/">can be found here</a>
        </div>
        <![endif]-->

        <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
            <symbol id="svg-icon-social-vimeo" width="30" height="30" viewBox="-26 20 30 30">
                <path d="M-23,30.2c2.1-1.7,5.1-4.8,7.5-4.8c2.3,0,2.9,2.2,3.2,4.7c0.3,2.5,1.2,7.8,2.5,7.8 c1.2,0,4.1-4.7,3.9-6.6c-0.2-1.8-2.2-1.6-3.3-1c1-3.7,3.4-5.8,6.5-5.8c3.1,0,3.8,2.3,3.8,4.9c0,3.9-8.2,16-13.1,16 c-3.1,0-3.8-4.4-4.4-6.6c-0.6-2.2-1.8-7.9-3.3-8.3c-0.6-0.1-2.1,1.1-2.1,1.1L-23,30.2z"/>
            </symbol>
            <symbol id="svg-icon-social-google" width="30" height="30" viewBox="-25 24 30 30">
                <path d="M-6.3 45.9c0 1-.3 2-.8 2.8-1.7 2.9-5.2 3.9-8.3 3.9-2.5 0-5.5-.6-6.9-2.9-.4-.6-.6-1.4-.6-2.1 0-1.9 1.1-3.4 2.7-4.3 1.9-1.2 4.4-1.5 6.6-1.6-.6-.8-1-1.4-1-2.4 0-.5.1-.9.3-1.4-.4 0-.7.1-1.1.1-3.2 0-5.8-2.3-5.8-5.6 0-1.8.9-3.6 2.2-4.8 1.8-1.5 4.3-2.1 6.6-2.1h6.9l-2.3 1.4H-10c1.5 1.3 2.5 2.7 2.5 4.8 0 4.2-3.9 4.7-3.9 6.8 0 2 5.1 2.7 5.1 7.4zm-2.3 1.4c0-2.2-2.2-3.6-3.8-4.7h-.8c-2.7 0-6.6.9-6.6 4.2 0 3.2 3.5 4.3 6.1 4.3 2.4 0 5.1-1 5.1-3.8zm-2.8-11.5c.7-.7.9-1.6.9-2.6 0-2.4-1.4-6.5-4.4-6.5-.9 0-1.9.5-2.4 1.2-.6.7-.8 1.7-.8 2.6 0 2.5 1.4 6.3 4.3 6.3.8 0 1.8-.4 2.4-1zm14.4.9v1.8H-.5v3.6h-1.7v-3.6h-3.5v-1.8h3.5v-3.6h1.7v3.6H3z">
            </symbol>
            <symbol id="svg-icon-social-twitter" width="30" height="30" viewBox="-25 20 30 30">
                <path d="M.4 29.7v.7c0 7-5.3 15.1-15.1 15.1-3 0-5.8-.9-8.1-2.4.4 0 .8.1 1.3.1 2.5 0 4.8-.8 6.6-2.3-2.3 0-4.3-1.6-5-3.7.3 0 .7.1 1 .1.5 0 1-.1 1.4-.2-2.4-.5-4.2-2.6-4.2-5.2v-.1c.7.4 1.5.6 2.4.7-1.4-1-2.4-2.6-2.4-4.4 0-1 .3-1.9.7-2.7 2.6 3.2 6.5 5.3 10.9 5.5-.1-.4-.1-.8-.1-1.2 0-2.9 2.4-5.3 5.3-5.3 1.5 0 2.9.6 3.9 1.7 1.2-.2 2.3-.7 3.4-1.3C2 26 1.2 27.1.1 27.7c1.1-.1 2.1-.4 3.1-.8C2.4 28 1.4 29 .4 29.7z">
            </symbol>
            <symbol id="svg-icon-social-facebook" width="30" height="30" viewBox="-31 24 30 30">
                <path d="M-8.7 29.8h-2.6c-2 0-2.4 1-2.4 2.4v3.1h4.8l-.6 4.9h-4.2v12.5h-5V40.1h-4.2v-4.9h4.2v-3.6c0-4.2 2.5-6.4 6.2-6.4 1.8 0 3.3.1 3.7.2v4.4z">
            </symbol>
            <symbol id="svg-icon-social-youtube" width="30" height="30" viewBox="-26 25 30 30">
                <path d="M.9 52c-.3 1.3-1.4 2.2-2.6 2.4-3 .3-6.1.3-9.1.3s-6.1 0-9.1-.3c-1.3-.1-2.3-1.1-2.6-2.4-.5-1.9-.5-3.9-.5-5.8s0-3.9.4-5.7c.3-1.3 1.4-2.2 2.6-2.4 3-.3 6.1-.3 9.1-.3s6.1 0 9.1.3c1.3.1 2.3 1.1 2.6 2.4.4 1.8.4 3.8.4 5.7.1 1.9.1 3.9-.3 5.8zm-17-9.8v-1.5h-5.1v1.5h1.7v9.3h1.6v-9.3h1.8zm2.7-16.9l-2 6.5v4.4H-17v-4.4c-.1-.8-.5-2-1-3.5-.4-1-.7-2.1-1.1-3.1h1.7l1.2 4.3 1.1-4.3h1.7zm1.8 26.2v-8.1h-1.5v6.2c-.3.5-.6.7-.9.7-.2 0-.3-.1-.3-.3v-6.6h-1.5v6.4c0 .6 0 1 .1 1.2.1.4.5.6 1 .6s1.1-.3 1.7-1v.9h1.4zM-9 33.6c0 .9-.1 1.5-.5 1.9-.4.6-1 .8-1.7.8s-1.3-.3-1.7-.8c-.3-.4-.5-1.1-.5-1.9v-2.9c0-.9.1-1.5.5-1.9.4-.6 1-.8 1.7-.8.8 0 1.3.3 1.7.8.3.4.5 1 .5 1.9v2.9zm-1.5-3.1c0-.8-.2-1.1-.7-1.1-.5 0-.7.4-.7 1.1v3.4c0 .8.2 1.1.7 1.1.5 0 .7-.4.7-1.1v-3.4zM-6 45.8c0-.8 0-1.3-.1-1.6-.2-.6-.6-.9-1.2-.9-.5 0-1 .3-1.5.9v-3.6h-1.5v10.9h1.5v-.8c.5.6 1 .9 1.5.9.6 0 1-.3 1.2-.9.1-.3.1-.9.1-1.6v-3.3zm-1.5 3.4c0 .7-.2 1.1-.6 1.1-.2 0-.5-.1-.7-.4V45c.2-.2.5-.4.7-.4.4 0 .6.4.6 1.1v3.5zm4-12.9H-5v-.9c-.6.7-1.1 1-1.7 1-.5 0-.8-.2-1-.6-.1-.2-.1-.6-.1-1.2v-6.5h1.5v6.6c0 .2.1.4.3.4.3 0 .6-.2.9-.7v-6.2h1.5v8.1zm3 12.4H-2v1c-.1.4-.3.6-.7.6-.5 0-.8-.4-.8-1.1v-1.4h2.9V46c0-.9-.1-1.5-.4-1.9-.4-.6-1-.8-1.7-.8-.8 0-1.3.3-1.8.8-.3.4-.5 1-.5 1.9v2.8c0 .9.2 1.5.5 1.9.4.6 1 .8 1.8.8s1.4-.3 1.8-.9c.2-.3.3-.6.3-.9v-1zM-2 46.5h-1.5v-.8c0-.7.2-1.1.7-1.1s.8.4.8 1.1v.8z">
            </symbol>
            <symbol id="svg-icon-social-linkedin" width="30" height="30" viewBox="-26 25 30 30">
                <path d="M-22.6 51.3h5v-15h-5v15zm17.8-15.5c-2.2 0-3.5.8-4.8 2.6v-2.1h-5v15h5v-8.1c0-1.7.9-3.4 2.8-3.4 2 0 3.2 1.7 3.2 3.4v8.2h5v-8.5c0-6-4-7.1-6.2-7.1zM-20.1 29c-1.6 0-2.9 1.2-2.9 2.6 0 1.5 1.3 2.6 2.9 2.6 1.6 0 2.9-1.2 2.9-2.6.1-1.4-1.2-2.6-2.9-2.6z">
            </symbol>
            <symbol id="svg-scroll-down" width="48" height="48" viewBox="0 0 48 48">
                <path d="M24 1C11.3 1 1 11.3 1 24s10.3 23 23 23 23-10.3 23-23S36.7 1 24 1zm0 31.5L11.9 21.6l1.3-1.5L24 29.8l10.7-9.7 1.3 1.5-12 10.9z">
            </symbol>
        </svg>

        <header id="header" class="SOZO-header js-hide-nav">

            <div class="wrapper">

                <a href="/" class="logo animate-me" title="Noesis">
                    <img src="/images/logos/noesis-gui-logo.svg" alt="NoesisGUI">
                </a>

                <div class="user-management">
                    <iframe src="/includes/user.php" scrolling="no"></iframe>
                </div>

                <a title="Menu" href="/" class="mobile-menu" rel="nofollow">
                    <i class="burger-icon"></i>
                </a>

                <nav class="primary-nav site-nav" role="navigation">
                    <ul>
                        <li><a href="/" title="NoesisGUI Main Features"><span>features</span></a></li>
                        <li><a href="/licensing.php" title="NoesisGUI Licensing"><span>licensing</span></a></li>
                        <li class="has-children"><a data-id="child-nav" href="/forums" title="NoesisGUI Developer Resources" class="js-mobile-2nd-nav active"><span>developer</span></a>
                            <nav class="child-nav" id="child-nav">
                                <ul>
                                    <li><a href="/forums" title="NoesisGUI Forums">forums</a></li>
                                    <li><a href="/developers/samples.php" title="NoesisGUI Samples">samples</a></li>
                                    <li><a href="/developers/downloads.php" title="NoesisGUI Downloads">downloads</a></li>
                                    <li><a href="/docs/Gui.Core.Index.html" title="NoesisGUI Documentation" class="active">documentation</a></li>
                                    <li><a href="/docs/Gui.Core.Changelog.html" title="NoesisGUI Version Changelog">changelog</a></li>
                                    <li><a href="https://bugs.noesisengine.com" target="_blank" rel="nofollow" title="NoesisGUI Bug Tracker">bugtracker</a></li>
                                    <li><a href="https://trello.com/b/ktVkZaBG/noesisgui" target="_blank" rel="nofollow" title="NoesisGUI Roadmap">roadmap</a></li>
                                </ul>
                            </nav>
                        </li>
                        <li><a href="/contact.php" title="Contact Information"><span>Contact</span></a></li>
                    </ul>
                </nav>

            </div>

        </header>

        <header id="doc-header">
            <img src="noesis-gui-logo.svg" alt="NoesisGUI">
        </header>

        <div class="main-content" role="main">

            <nav id="noesis-secondary-nav" class="secondary-nav site-nav js-hide-nav">
                <div class="wrapper">
                    <ul>
                        <li><a href="/forums" title="NoesisGUI Forums">forums</a></li>
                        <li><a href="/developers/samples.php" title="NoesisGUI Samples">samples</a></li>
                        <li><a href="/developers/downloads.php" title="NoesisGUI Downloads">downloads</a></li>
                        <li><a href="/docs/Gui.Core.Index.html" title="NoesisGUI Documentation" class="active">documentation</a></li>
                        <li><a href="/docs/Gui.Core.Changelog.html" title="NoesisGUI Version Changelog">changelog</a></li>
                        <li><a href="https://bugs.noesisengine.com" target="_blank" rel="nofollow" title="NoesisGUI Bug Tracker">bugtracker</a></li>
                        <li><a href="https://trello.com/b/ktVkZaBG/noesisgui" target="_blank" rel="nofollow" title="roadmap">roadmap</a></li>
                    </ul>
                </div>
            </nav>


            <div class="documentation-article">

                <div class="wrapper">

                    <div id="noesis_web_contenidosMain" class="noesis_web_contenidosMain sozo-content">
                        <div id="noesis_doc_wrap">

                            <div class="noesis_doc_header_menu">
                                <a href="Gui.Core.Index.html" class="noesis_doc_header_link">Documentation Index</a>
                            </div>

                            <div class="noesis_doc_content">

        <!-- NOESIS WEB ------- END ------- -->


<h1 class="title">Memory Management</h1>

<p>NoesisEngine is designed to allow controlling how memory allocations and deallocations are managed. Different layers are defined. At the lowest level we find the Kernel Memory Manager.</p>
<div class="section" id="kernel-memorymanager">
<h1>Kernel MemoryManager</h1>
<p>The <em>MemoryManager</em> class is the Kernel module in charge of memory allocations during the Kernel lifetime. After initializing the Kernel, the memory manager is ready to be used by any package.</p>
<p>The memory manager offers two kind of functionality: <strong>memory tracking</strong> and <strong>memory allocation</strong>.</p>
<div class="section" id="memory-tracking">
<h2>Memory Tracking</h2>
<p>Memory manager holds information about every memory block that is allocated. This information is stored inside the struct MemBlockInfo.</p>
<div class="highlight"><pre><span></span><span class="k">struct</span> <span class="n">MemBlockInfo</span>
<span class="p">{</span>
    <span class="kt">void</span><span class="o">*</span> <span class="n">userPtr</span><span class="p">;</span>          <span class="c1">// Pointer returned to the user</span>
    <span class="kt">void</span><span class="o">*</span> <span class="n">blockPtr</span><span class="p">;</span>         <span class="c1">// Pointer of the whole memory block</span>
    <span class="n">MemBlockInfo</span><span class="o">*</span> <span class="n">prev</span><span class="p">;</span>     <span class="c1">// Link to the previus block in the allocation block list</span>
    <span class="n">MemBlockInfo</span><span class="o">*</span> <span class="n">next</span><span class="p">;</span>     <span class="c1">// Link to the next block in the allocation block list</span>
    <span class="n">NsInt64</span><span class="o">*</span> <span class="n">callStack</span><span class="p">;</span>     <span class="c1">// Pointer to the call stack of the allocation. Could be null</span>
    <span class="n">NsSize</span> <span class="n">callStackDepth</span><span class="p">;</span>  <span class="c1">// Call stack depth</span>
    <span class="n">NsInt32</span> <span class="n">allocId</span><span class="p">;</span>        <span class="c1">// Identifier assigned to each allocation operation</span>
    <span class="n">NsUInt32</span> <span class="n">threadId</span><span class="p">;</span>      <span class="c1">// Identifier of the thread that is performing the allocation operation</span>
    <span class="n">NsSize</span> <span class="n">size</span><span class="p">;</span>            <span class="c1">// Size requested by the user</span>
<span class="p">};</span>
</pre></div>
<p>This information is used to generate reports like, for example, memory leaks when the kernel is being closed. Memory-Leak reports can be accompanied with call-stack for each allocated block if those information is available. If memory tracker is enabled, when the memory manager is shut down the remaining allocated blocks are dumped to the console as memory leaks.</p>
<p>Also, you can get a snapshot of the current memory status, and use that information to calculate memory consumption of some code blocks. This is achieved with the <em>GetStats()</em> function.</p>
<div class="highlight"><pre><span></span><span class="k">struct</span> <span class="n">MemoryManager</span><span class="o">::</span><span class="n">Stats</span>
<span class="p">{</span>
    <span class="n">NsUInt32</span> <span class="n">allocs</span><span class="p">;</span>            <span class="c1">// current allocated blocks</span>
    <span class="n">NsUInt32</span> <span class="n">allocsTotal</span><span class="p">;</span>       <span class="c1">// total allocation operations</span>
    <span class="n">NsSize</span> <span class="n">memory</span><span class="p">;</span>              <span class="c1">// current memory used</span>
    <span class="n">NsSize</span> <span class="n">memoryMax</span><span class="p">;</span>           <span class="c1">// maximum memory used</span>
    <span class="n">NsSize</span> <span class="n">memoryTotal</span><span class="p">;</span>         <span class="c1">// total memory requested</span>
    <span class="n">NsSize</span> <span class="n">memoryWasted</span><span class="p">;</span>        <span class="c1">// current memory wasted by memory manager data</span>
    <span class="n">NsSize</span> <span class="n">memoryWastedTotal</span><span class="p">;</span>   <span class="c1">// total memory wasted by memory manager data</span>
<span class="p">};</span>
</pre></div>
</div>
<div class="section" id="memory-allocations">
<h2>Memory Allocations</h2>
<p>Memory allocations are not directly performed by the memory manager. This task is delegated to another class, the MemoryAllocator.</p>
<div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MemoryAllocator</span>
<span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
    <span class="c1">/// Allocates a block of memory of specified size</span>
    <span class="c1">/// \param size Size in bytes of the block requested by the user</span>
    <span class="c1">/// \param alignment Pointer returned must be aligned to this value</span>
    <span class="c1">/// \return A pointer to the new allocated block of memory</span>
    <span class="c1">/// \remarks Thread-safe</span>
    <span class="k">virtual</span> <span class="kt">void</span><span class="o">*</span> <span class="n">Alloc</span><span class="p">(</span><span class="n">NsSize</span> <span class="n">size</span><span class="p">,</span>
                        <span class="n">NsSize</span> <span class="n">alignment</span> <span class="o">=</span> <span class="n">NS_DEFAULT_MEMORY_ALIGNMENT</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

    <span class="c1">/// Reallocates a block of memory</span>
    <span class="c1">/// \param ptr Pointer to previously allocated memory block</span>
    <span class="c1">/// \param size New size in bytes</span>
    <span class="c1">/// \param alignment Pointer returned must be aligned to this value</span>
    <span class="c1">/// \return A pointer to the new allocated block of memory</span>
    <span class="c1">/// \remarks Thread-safe</span>
    <span class="k">virtual</span> <span class="kt">void</span><span class="o">*</span> <span class="nf">Realloc</span><span class="p">(</span><span class="kt">void</span><span class="o">*</span> <span class="n">ptr</span><span class="p">,</span>
                          <span class="n">NsSize</span> <span class="n">size</span><span class="p">,</span>
                          <span class="n">NsSize</span> <span class="n">alignment</span> <span class="o">=</span> <span class="n">NS_DEFAULT_MEMORY_ALIGNMENT</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

    <span class="c1">/// Deallocates a block of memory</span>
    <span class="c1">/// \param ptr Pointer to previously allocated memory block</span>
    <span class="c1">/// \remarks Thread-safe</span>
    <span class="k">virtual</span> <span class="kt">void</span> <span class="nf">Dealloc</span><span class="p">(</span><span class="kt">void</span><span class="o">*</span> <span class="n">ptr</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>
<p>This layer is defined to allow developers to provide its own allocation algorithms. When Kernel is initialized, the user could supply a custom MemoryAllocator object. This object is passed to memory manager and is used to perform all allocation operations.
NoesisEngine implements a default MemoryAllocator based on standard <em>malloc()</em> and <em>free()</em> functions, the <em>AnsiAllocator</em>. That one is used if no allocator is given.</p>
<p>The allocator to be used by the Kernel is passed to the Init() function.</p>
<div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Kernel</span>
<span class="p">{</span>
    <span class="p">...</span>
    <span class="c1">/// Initializes the kernel</span>
    <span class="k">virtual</span> <span class="kt">void</span> <span class="n">Init</span><span class="p">(</span><span class="k">const</span> <span class="n">CommandLine</span><span class="o">&amp;</span> <span class="n">commandLine</span><span class="p">,</span> <span class="n">MemoryAllocator</span><span class="o">*</span> <span class="n">memoryAllocator</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">...</span>
<span class="p">};</span>
</pre></div>
</div>
<div class="section" id="configuration">
<h2>Configuration</h2>
<p>The <a class="reference external" href="Core.Kernel.Configuration.html">Configuration Mechanism</a> is used to activate the different debug features of the Memory Manager. The following options are available:</p>
<ul class="simple">
<li><em>Kernel.MemoryManager.TrackMemory</em>. When this option is true, memory manager tracking is enabled. The default value is <em>false</em>.</li>
<li><em>Kernel.MemoryManager.StoreCallStack</em>. This option controls if a call stack is generated for each allocation. It is only available if tracking is enabled. The default value is <em>false</em>.</li>
<li><em>Kernel.MemoryManager.CallStackDepth</em>. This options sets the depth of the call stack. It is only available if call stacks are stored. The default value is <em>4</em>.</li>
</ul>
</div>
</div>
<div class="section" id="global-operators">
<h1>Global operators</h1>
<div class="section" id="nsalloc-nsrealloc-nsdealloc">
<h2>NsAlloc, NsRealloc, NsDealloc</h2>
<p>NsAlloc, NsRealloc and NsDealloc are shortcuts to the functions that are available in the memory manager. These functions can't be used if kernel is not initialized.</p>
<div class="highlight"><pre><span></span><span class="c1">////////////////////////////////////////////////////////////////////////////////////////////////////</span>
<span class="c1">/// NoesisEngine global memory management.</span>
<span class="c1">////////////////////////////////////////////////////////////////////////////////////////////////////</span>
<span class="c1">//@{</span>
<span class="n">NS_CORE_KERNEL_API</span>
<span class="kt">void</span><span class="o">*</span> <span class="nf">NsAlloc</span><span class="p">(</span><span class="n">NsSize</span> <span class="n">size</span><span class="p">,</span> <span class="n">NsUInt</span> <span class="n">alignment</span> <span class="o">=</span> <span class="n">NS_DEFAULT_MEMORY_ALIGNMENT</span><span class="p">);</span>

<span class="n">NS_CORE_KERNEL_API</span>
<span class="kt">void</span><span class="o">*</span> <span class="nf">NsRealloc</span><span class="p">(</span><span class="kt">void</span><span class="o">*</span> <span class="n">ptr</span><span class="p">,</span> <span class="n">NsSize</span> <span class="n">size</span><span class="p">,</span> <span class="n">NsUInt</span> <span class="n">alignment</span> <span class="o">=</span> <span class="n">NS_DEFAULT_MEMORY_ALIGNMENT</span><span class="p">);</span>

<span class="n">NS_CORE_KERNEL_API</span>
<span class="kt">void</span> <span class="nf">NsDealloc</span><span class="p">(</span><span class="kt">void</span><span class="o">*</span> <span class="n">ptr</span><span class="p">);</span>

<span class="k">template</span><span class="o">&lt;</span><span class="k">class</span> <span class="nc">T</span><span class="o">&gt;</span> <span class="n">T</span><span class="o">*</span> <span class="n">NsAlloc</span><span class="p">(</span><span class="n">NsSize</span> <span class="n">count</span><span class="p">,</span> <span class="n">NsUInt</span> <span class="n">alignment</span> <span class="o">=</span> <span class="n">NS_DEFAULT_MEMORY_ALIGNMENT</span><span class="p">);</span>
<span class="c1">//@}</span>
</pre></div>
<p>These functions offers the same functionality that the standard ones plus the support for requesting a memory alignment. It also exists a templated version of the <em>NsAlloc</em> function to request memory for a specific type of object. Here you specify the number of objects to be created:</p>
<div class="highlight"><pre><span></span><span class="k">struct</span> <span class="n">Data</span>
<span class="p">{</span>
    <span class="n">NsInt</span> <span class="n">id</span><span class="p">;</span>
    <span class="n">NsFloat32</span> <span class="n">value</span><span class="p">;</span>
<span class="p">};</span>

<span class="n">Data</span><span class="o">*</span> <span class="n">dataArray</span> <span class="o">=</span> <span class="n">NsAlloc</span><span class="o">&lt;</span><span class="n">Data</span><span class="o">&gt;</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>
</pre></div>
<p>This function must only be used for types without contructor and destructor.</p>
</div>
<div class="section" id="ansialloc-ansirealloc-ansidealloc">
<h2>AnsiAlloc, AnsiRealloc, AnsiDealloc</h2>
<p>These functions define the standard <em>malloc</em>, <em>realloc</em> and <em>free</em> operations, but wrapped to support alignment, and to hide the implementation details for every platform.</p>
</div>
<div class="section" id="operator-new-and-delete">
<h2>Operator new and delete</h2>
<p>Global operator <em>new</em> and <em>delete</em> are reimplemented on each compilation unit that define <em>NS_OVERLOAD_OPERATOR_NEW</em>. By default, NoesisEngine packages have it defined.[[BR]]</p>
<p>They use the global functions <em>AnsiAlloc</em> and <em>AnsiDealloc</em> while kernel is not initialized and kernel's memory manager when initialized. Because of this it is not allowed to deallocate memory during kernel lifetime that was allocated before kernel initialization. In the same way, it is not allowed to deallocate memory after kernel shut down that was allocated during kernel lifetime. These two situations will produce a crash.</p>
</div>
</div>
<div class="section" id="components">
<h1>Components</h1>
<p>In a higher layer we define components. Components must inherit from <em>BaseComponent</em> base class. They are objects with a lifetime guided by a <a class="reference external" href="Core.Kernel.ComponentReferenceCounting.html">reference count</a> policy. That is, you are not responsible for directly deleting the object, only for releasing your reference. It is easier to manage components by using <a class="reference external" href="Core.Kernel.ComponentSmartPointer.html">smart pointers</a>, that take care of incrementing and decrementing references for you.</p>
<p>Components are created using the kernel <a class="reference external" href="Core.Kernel.ComponentCreation.html">component factory</a>. To create a component you only need to know its class identifier.</p>
<div class="highlight"><pre><span></span><span class="n">ComponentFactory</span><span class="o">*</span> <span class="n">factory</span> <span class="o">=</span> <span class="n">NsGetKernel</span><span class="p">()</span><span class="o">-&gt;</span><span class="n">GetComponentFactory</span><span class="p">();</span>
<span class="n">Ptr</span><span class="o">&lt;</span><span class="n">IStream</span><span class="o">&gt;</span> <span class="n">stream</span> <span class="o">=</span> <span class="n">factory</span><span class="o">-&gt;</span><span class="n">CreateComponent</span><span class="p">(</span><span class="n">NSS</span><span class="p">(</span><span class="s">&quot;MemoryStream&quot;</span><span class="p">));</span>
<span class="n">stream</span><span class="o">-&gt;</span><span class="n">SetLength</span><span class="p">(</span><span class="mi">1024</span><span class="p">);</span>
</pre></div>
<p>The reference owned by your Ptr variable is automatically released when the variable goes out of scope.</p>
</div>


        <!-- NOESIS WEB ------- BEGIN ------- -->

                            </div> <!-- eo noesis_doc_content -->
                        </div> <!-- eo doc_wrap -->
                    </div> <!-- eo noesis_web_contenidosMain -->

                </div> <!-- eo wrapper -->

            </div>  <!-- eo documentation-article -->

        </div> <!-- eo main-content -->

        <footer id="footer" class="SOZO-footer">
            <div class="wrapper">
                <ul class="footer social-icon-list">
                    <li>
                        <a href="https://twitter.com/noesisengine" title="Noesis Twitter" target="_blank">
                            <i class="svg-icon">
                                <svg class="icon-social-twitter">
                                    <use xlink:href="#svg-icon-social-twitter"></use>
                                </svg>
                            </i>
                        </a>
                    </li>
                    <li>
                        <a href="https://www.linkedin.com/company/noesis-technologies-sl" title="Noesis Linkedin" target="_blank">
                            <i class="svg-icon">
                                <svg class="icon-social-linkedin">
                                    <use xlink:href="#svg-icon-social-linkedin"></use>
                                </svg>
                            </i>
                        </a>
                    </li>
                    <li>
                        <a href="https://vimeo.com/noesisengine" title="Noesis Vimeo" target="_blank">
                            <i class="svg-icon">
                                <svg class="icon-social-vimeo">
                                    <use xlink:href="#svg-icon-social-vimeo"></use>
                                </svg>
                            </i>
                        </a>
                    </li>
                    <li>
                        <a href="https://www.youtube.com/user/NoesisTechnologies" title="Noesis Youtube" target="_blank">
                            <i class="svg-icon">
                                <svg class="icon-social-youtube">
                                    <use xlink:href="#svg-icon-social-youtube"></use>
                                </svg>
                            </i>
                        </a>
                    </li>
                </ul>

                <div class="footer-extended">

                    <div class="cols">

                        <nav class="unit">
                            <h3 class="title">home</h3>
                            <ul>
                                <li><a href="/#goto-home-main-features" class="goto" title="NoesisGUI Main Features">Features</a></li>
                                <li><a href="/#goto-home-apis" class="goto" title="NoesisGUI APIs and Integrations">Integrations</a></li>
                                <li><a href="/#goto-home-platforms" class="goto" title="NoesisGUI Supported Platforms">Platforms</a></li>
                                <li><a href="/#goto-home-clients" class="goto" title="NoesisGUI Happy Clients">Clients</a></li>
                            </ul>
                        </nav>

                        <nav class="unit">
                            <h3 class="title">Licensing</h3>
                            <ul>
                                <li><a href="/licensing.php#goto-licensing-prices" class="goto" title="NoesisGUI Prices">Prices</a></li>
                                <li><a href="/licensing.php#goto-licensing-faqs" class="goto" title="NoesisGUI Licensing FAqs">FAQs</a></li>
                            </ul>
                        </nav>

                        <nav class="unit">
                            <h3 class="title">Developers</h3>
                            <ul>
                                <li>
                                    <div style="display:block;padding: 0.4em 0;">
                                        <a href="/forums" class="goto" title="NoesisGUI Forums" style="display:inline;margin-right:1em;">Forums</a>
                                        <a href="https://bugs.noesisengine.com" class="goto" target="_blank" rel="nofollow" title="NoesisGUI Bug Tracker"style="display:inline;">Bugtracker</a>
                                    </div>
                                </li>
                                <li>
                                    <div style="display:block;padding: 0.4em 0;">
                                        <a href="/developers/samples.php" class="goto" title="NoesisGUI Samples and Tutorials"style="display:inline;margin-right:1em;">Samples</a>
                                        <a href="/developers/downloads.php" class="goto" title="NoesisGUI Downloads" style="display:inline;">Downloads</a>
                                    </div>
                                </li>
                                <li>
                                    <div style="display:block;padding: 0.4em 0;">
                                        <a href="https://trello.com/b/ktVkZaBG/noesisgui" class="goto" target="_blank" rel="nofollow" title="NoesisGUI Roadmap"style="display:inline;margin-right:1em;">Roadmap</a>
                                        <a href="/docs/Gui.Core.Changelog.html" class="goto" title="NoesisGUI Version Changelog"style="display:inline;">Changelog</a>
                                    </div>
                                </li>
                                <li>
                                    <a href="/docs/Gui.Core.Index.html" class="goto" title="NoesisGUI Documentation">Documentation</a>
                                </li>
                            </ul>
                        </nav>

                        <nav class="unit">
                            <h3 class="title">Contact</h3>
                            <ul>
                                <li><a href="/contact.php#goto-contact-about" class="goto" title="About Noesis">About</a></li>
                                <li><a href="/contact.php#goto-contact-details" class="goto" title="Contact Noesis">Contact details</a></li>
                            </ul>
                        </nav>

                    </div>

                    <nav class="legal">
                        <figure class="SOZO-media logo">
                            <img src="/images/logos/noesis-logo-stacked.png">
                        </figure>
                        <p>&copy; 2017 Noesis Technologies</p>
                        <a href="/legal/privacy.php" title="Privacy Policy" rel="nofollow">Privacy</a>
                        <a href="/legal/cookies.php" title="Cookie Policy" rel="nofollow">Cookies</a>
                        <a href="/legal/terms-of-use.php" title="Terms and Conditions" rel="nofollow">Terms &amp; Conditions</a>
                    </nav>

                </div>

                <div class="footer-reduced">
                    <ul>
                        <li><a href="/" class="goto" title="NoesisGUI Main Features">Features</a></li>
                        <li><a href="/licensing.php" class="goto" title="NoesisGUI Prices">Licensing</a></li>
                        <li><a href="/forums" class="goto" title="NoesisGUI Forums">Developer</a></li>
                        <li><a href="/contact.php" class="goto" title="NoesisGUI Prices">Contact</a></li>
                    </ul>
                    <ul class="copyright-legal">
                        <li>&copy; 2017 Noesis Technologies</li>
                        <li><a href="/legal/privacy.php" title="Privacy Policy" rel="nofollow">Privacy</a></li>
                        <li><a href="/legal/terms-of-use.php" title="Terms and Conditions" rel="nofollow">Terms &amp; Conditions</a></li>
                    </ul>
                </div>
            </div>
        </footer>

        <footer id="doc-footer">
            <span>&copy; 2017 Noesis Technologies</span>
        </footer>

    </div> <!-- eo developers documentation -->

    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
    <!-- Use if you want latest version of 1x -->
    <!-- <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script> -->

    <!-- If using 1.11.3 make sure you update the fallback file below to 1.11.3 -->
    <script>window.jQuery || document.write('<script src="/js/vendor/jquery.js"><\/script>')</script>

    <script src="/js/plugins.1481882071.js"></script><script src="/js/main.1485346364.js"></script>

    <!-- NOESIS WEB ------- END ------- -->


</div>
</body>
</html>
